# Staged: src/app/reports/page.tsx

```
{"status":"success","output":"if (!content || isTooLarge) return \"\";\n    if (ext === 'json') {\n      try {\n        return JSON.stringify(JSON.parse(content), null, 2);\n      } catch {\n        return content;\n      }\n    }\n    return content;\n  }, [content, ext, isTooLarge]);\n\n  if (isEditing) {\n    return (\n      <textarea\n        value={editContent}\n        onChange={(e) => setEditContent(e.target.value)}\n        className=\"flex-1 bg-[#fdfcf6] p-6 font-mono text-sm resize-none focus:outline-none text-gray-900 leading-relaxed custom-scrollbar overflow-y-auto whitespace-pre-wrap break-all\"\n        spellCheck={false}\n        autoFocus\n      />\n    );\n  }\n\n  if (ext === 'md') {\n    return (\n      <div className=\"flex-1 overflow-auto p-8 max-w-full min-w-0 custom-scrollbar bg-[#fdfcf6] text-gray-900 markdown-preview break-words\">\n        <ReactMarkdown\n          remarkPlugins={[remarkGfm]}\n          components={{\n            code({ inline, className, children, ...props }: MarkdownCodeProps) {\n              const { style: _style, ...rest } = props;\n              void _style;\n              const match = /language-(\\w+)/.exec(className || '');\n              if (!inline && match) {\n                return (\n                  <SyntaxHighlighter\n                    style={syntaxTheme}\n                    language={match[1]}\n                    PreTag=\"div\"\n                    wrapLongLines={true}\n                    customStyle={{\n                      margin: 0,\n                      padding: '1.25rem',\n                      fontSize: '0.9em',\n                      backgroundColor: '#f9fafb',\n                      borderRadius: '0.75rem',\n                      border: '1px solid #e5e7eb',\n                      whiteSpace: 'pre-wrap',\n                      wordBreak: 'break-all'\n                    }}\n                    {...rest}\n                  >\n                    {String(children).replace(/\\n$/, '')}\n                  </SyntaxHighlighter>\n                );\n              }\n              return (\n                <code\n                  className={`${className} ${!inline ? 'block p-6 whitespace-pre-wrap break-all bg-[#f9fafb] rounded-xl border border-[#e5e7eb]' : ''}`}\n                  {...props}\n                >\n                  {children}\n                </code>\n              );\n            }\n          }}\n        >\n          {content}\n        </ReactMarkdown>\n      </div>\n    );\n  }\n\n  return (\n    <pre className=\"flex-1 overflow-auto p-6 font-mono text-sm text-gray-900 bg-[#fdfcf6] custom-scrollbar whitespace-pre-wrap break-all min-h-0 min-w-0 max-w-full\">\n      {isTooLarge ? (\n        <code className=\"whitespace-pre-wrap break-all\">{content}</code>\n      ) : (\n        <code className=\"whitespace-pre-wrap break-all\" dangerouslySetInnerHTML={{ __html: renderedContent }} />\n      )}\n    </pre>\n  );\n};\n\nexport default function ReportsPage() {\n  const { t } = useLanguage();\n  const router = useRouter();\n  const pathname = usePathname();\n  const searchParams = useSearchParams();\n  const selectedPath = searchParams.get(\"path\");\n\n  const [nodes, setNodes] = useState<LogNode[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [content, setContent] = useState(\"\");\n  const [editContent, setEditContent] = useState(\"\");\n  const [isEditing, setIsEditing] = useState(false);\n  const [saving, setSaving] = useState(false);\n  const [registering, setRegistering] = useState<string | null>(null);\n  const [expandedFolders, setExpandedFolders] = useState<Set<string>>(new Set());\n  const [translatingPaths, setTranslatingPaths] = useState<Set<string>>(new Set());\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const deferredSearch = useDeferredValue(searchQuery);\n\n  const fetchList = useCallback(async (silent = false) => {\n    if (!silent) setLoading(true);\n    try {\n      const res = await fetch(\"/api/reports/list\");\n      const data = await res.json();\n\n      if (res.status === 401) {\n        router.push(\"/login?callback=/reports\");\n        return;\n      }\n\n      if (data.files) setNodes(data.files);\n    } catch (err) {\n      console.error(\"Fetch reports list error:\", err);\n    } finally {\n      if (!silent) setLoading(false);\n    }\n  }, [router]);\n\n  const fetchTranslatingStatus = useCallback(async () => {\n    try {\n      const res = await fetch(\"/api/reports/translate\");\n      if (res.ok) {\n        const data = await res.json();\n        if (data.translatingPaths) {\n          setTranslatingPaths(new Set(data.translatingPaths));\n        }\n      }\n    } catch (err) {\n      console.error(\"Fetch translating status error:\", err);\n    }\n  }, []);\n\n  useEffect(() => {\n    fetchList();\n    fetchTranslatingStatus();\n    const intervalMs = parseInt(process.env.NEXT_PUBLIC_LOG_REFRESH_INTERVAL_MS || \"10000\");\n    const interval = setInterval(() => {\n      fetchList(true);\n      fetchTranslatingStatus();\n    }, intervalMs);\n\n    return () => clearInterval(interval);\n  }, [fetchList, fetchTranslatingStatus]);\n\n  useEffect(() => {\n    if (!selectedPath) {\n      setContent(\"\");","exitCode":0}
```