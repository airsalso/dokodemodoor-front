{
  "vulnerabilities": [
    {
      "ID": "XSS-VULN-01",
      "vulnerability_type": "Stored",
      "externally_exploitable": true,
      "severity": "High",
      "source": "POST /api/reports/file (content) – src/app/reports/page.tsx:382-408",
      "path": "content (API) → renderedContent (useMemo) → dangerouslySetInnerHTML",
      "sink_function": "dangerouslySetInnerHTML",
      "render_context": "HTML_BODY",
      "encoding_observed": "None",
      "verdict": "vulnerable",
      "mismatch_reason": "Unescaped user content is rendered directly into the DOM without any encoding or sanitization.",
      "witness_payload": "<img src=x onerror=alert(1)>",
      "confidence": "high",
      "notes": "No CSP header; React bypass via dangerouslySetInnerHTML. Any authenticated user can create a report that will be executed in other users' browsers."
    },
    {
      "ID": "XSS-VULN-02",
      "vulnerability_type": "Stored",
      "externally_exploitable": true,
      "severity": "Medium",
      "source": "GET /api/reports/file?path= – src/app/logs/page.tsx:240-278",
      "path": "content (API) → renderedContent (useMemo) → dangerouslySetInnerHTML",
      "sink_function": "dangerouslySetInnerHTML",
      "render_context": "HTML_BODY",
      "encoding_observed": "None",
      "verdict": "vulnerable",
      "mismatch_reason": "Log content is rendered without sanitization; if logs contain attacker-controlled data, XSS is possible.",
      "witness_payload": "<img src=x onerror=alert(1)>",
      "confidence": "high",
      "notes": "Logs are not user-editable but may contain data from external sources; risk depends on log content."
    }
  ]
}